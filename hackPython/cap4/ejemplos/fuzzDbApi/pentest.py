from pywebfuzz import fuzzdb
import requests

class FunTester:
    def __init__(self, domain='http://www.google.com'):
        self.domain = domain
        self.logins = fuzzdb.Discovery.PredictableRes.Logins
        self.methods = fuzzdb.attack_payloads.http_protocol.http_protocol_methods

    def get_login(self):
        """
        Function to test every route in a domain to extract the login route
        """
        for login in self.logins:
            print("Testing...", self.domain, login)
            response = requests.get(self.domain,login)
            if response.status_code == 200:
                print("Login resource: ", login)

    def get_methods(self):
        """
        Function that returns the http methods allowed by the server
        """
        for method in self.methods:
            print("Testing...", self.domain, method)
            response = requests.get(self.domain,method)
            if response.status_code not in range(400, 599):
                print("Method Allowd: ", method)
